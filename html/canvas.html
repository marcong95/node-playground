<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Canvas Demo</title>
</head>
<body>
  <img src="" alt="Canvas output" id="output">
  <!-- <img src="https://marcong.tech/images/mc_pc.png" alt="Marco's avatar" id="marco" style="display: none;"> -->
  <script>
    const THUMBNAIL_SIZE = 180;
    const path = 'M-317.8,167.5L-320.3,187.6L-324.7,213.2L-325.4,240.1L-323.7,279.0L-326.1,307.3L-330.4,326.4L-335.5,336.9L-338.6,343.4L-340.3,333.2L-343.7,317.1L-346.0,296.6L-348.1,268.4L-352.4,239.6L-357.3,212.0L-360.6,195.0L-361.7,180.3L-362.7,170.0L-363.6,165.3L-362.3,163.1L-361.4,166.5L-362.4,175.0L-361.9,185.3L-362.0,197.4L-361.3,208.6L-360.5,217.4L-359.7,224.6L-357.6,229.7L-356.3,233.0L-355.0,234.9L-353.3,236.9L-350.9,239.4L-346.3,244.6L-330.0,244.3L-319.7,248.8L-310.6,257.2L-292.1,259.1L-259.6,261.5L-227.6,267.4L-193.1,272.5L-160.2,273.2L-130.2,267.9L-109.6,267.8L-92.4,268.4L-72.5,267.9L-52.2,264.9L-37.2,260.3L-28.1,254.3L-17.7,245.1L-10.3,234.4L-2.3,221.1L6.1,202.1L22.3,179.6L51.9,159.7L85.5,139.2L120.7,120.0L155.9,105.5L159.1,100.3L172.4,91.8L175.9,84.9L165.5,84.8L152.7,92.1L128.8,103.1L91.0,112.1L54.6,119.9L23.0,127.5L-3.3,133.6L-8.8,137.1L-20.7,142.8L-27.9,148.9L-34.1,145.7L-49.1,140.4L-75.9,143.6L-104.7,147.3L-126.1,146.8L-133.8,142.5L-142.5,141.8L-149.4,141.1L-149.4,141.0L-149.3,142.2L-145.2,153.4L-130.8,165.8L-104.3,168.5L-78.7,169.8L-59.9,173.9L-52.2,180.2L-43.5,180.2L-36.5,177.2L-33.8,171.1L-31.8,163.1L-30.5,154.1L-30.1,144.5L-29.4,131.0L-28.4,113.4L-27.8,91.0L-25.2,65.1L-21.5,40.8L-17.6,23.3L-14.5,12.7L-10.7,-0.8L-7.1,-19.8L-4.0,-44.5L-1.4,-67.4L1.5,-87.0L7.0,-103.3L11.5,-115.7L15.0,-127.6L18.1,-144.1L23.8,-168.0L26.1,-187.5L23.3,-192.4L29.6,-189.5L35.6,-188.0L36.8,-189.3L38.2,-188.9L41.2,-179.2L45.9,-159.3L46.9,-131.5L45.4,-92.9L48.3,-55.4L55.8,-24.7L55.7,13.9L56.6,65.4L61.3,119.7L62.1,172.8L59.3,214.4L55.3,238.1L57.6,252.5L61.8,257.5L64.1,249.7L65.2,230.5L70.4,197.6L74.7,148.4L77.4,91.2L83.1,31.9L89.7,-23.0L95.7,-70.1L98.3,-110.1L92.0,-134.1L88.6,-139.6L86.9,-127.5L80.9,-101.2L76.8,-61.8L74.7,-15.9L73.3,35.3L75.3,87.3L80.1,138.4L87.5,185.4L101.5,218.6L109.2,237.1L116.1,239.7L122.5,232.0L127.1,215.6L131.3,193.2L137.3,167.6L141.9,140.7L145.6,111.5L147.7,80.2L149.8,49.0L153.3,20.1L156.6,-2.9L161.5,-19.7L167.1,-29.9L171.5,-37.4L171.8,-46.5L170.8,-51.5L169.2,-51.3L170.9,-45.4L173.0,-35.4L172.8,-23.8L169.8,-8.6L167.4,4.6L169.4,17.2L179.7,30.1L198.9,44.3L222.5,54.8L246.3,58.1L268.4,54.9L290.8,45.2L316.4,31.8L347.5,17.9L377.3,5.4L403.8,-6.1L414.1,-24.2L415.7,-45.4L415.2,-68.5L385.6,-74.5L356.7,-87.9L321.5,-95.9L277.3,-97.0L231.5,-96.4';

    async function getThumbnail(size = THUMBNAIL_SIZE) {
      const canvas = document.createElement('canvas');
      canvas.width = size;
      canvas.height = size;
      const ctx = canvas.getContext('2d');

      const track = new Path2D();
      const scaleRatio = size / 840;
      const matrix =
         document.createElementNS('http://www.w3.org/2000/svg', 'svg')
           .createSVGMatrix()
           .translate(size / 2, size / 2)
           .scale(scaleRatio, scaleRatio)

      track.addPath(new Path2D(path), matrix);
      ctx.lineWidth = 1;
      ctx.strokeStyle = '#00f';
      ctx.stroke(track);

      ctx.strokeStyle = '#000';
      ctx.strokeRect(80, 160, 40, 10);

      return canvas.toDataURL('image/png');
    }

    window.onload = () => {
      getThumbnail().then(url => {
        document.getElementById('output').src = url;
      })
    }
  </script>
</body>
</html>
